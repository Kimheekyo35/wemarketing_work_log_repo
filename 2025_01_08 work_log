# 2025_01_08 work_log 

🔥 금일 목표
1. 선크림 자동화 프로젝트에서 (홈페이지 상에선 다르지만) 같은 데이터 제거하는 함수 만들기
2. proxy를 사용했을 때 제대로 못 가져오는 이유 파악, 로그인 쿠키 적용 안 되는 문제 발생
3. 선크림 자동화 프로젝트에서 자사 제품은 하이라이트 표시

🚦 업무 순서
1. SQL로 데이터 제거하는 함수 만들기
2. 선크림 자동화 프로젝트에서 자사 제품은 하이라이트 표시
3. 로그인이 필요한 사이트 접근 불가능한 원인 파악

🚨 문제점
1. 브랜드명, 제품명, 가격, 할인 전 가격 등 같은 상품이 등록된 점은 처음 -> 전일 23위와 100위가 중복으로 계산되어 금일 자료에서 23위가 두개 나오는 문제 발생
2. proxy를 활용했을 때 제대로 크롤링이 안 됨 
3. 로그인이 필요한 사이트에 로컬에서도 접근 불가능 -> 쿠키가 바뀌었음. 

💫✏️📌
query = """
    DELETE FROM suncream_crawling.jolse
    WHERE id NOT IN (
        SELECT MIN(id)
        FROM suncream_crawling.jolse
        GROUP BY "Brand", "Product", "Old_price", "Price", "DateTime"
    );
"""
# 같은 브랜드, 상품명, 가격을 가진 상품 중에서도 가장 순위가 높은 상품빼곤 제외시키는 코드
새로운 함수를 만들어서 DB 적재한 후 다시 한번 함수를 호출하여 삭제

X의 경우 쿠키가 빈번하게 바뀌는 것 같음. 쿠키를 새롭게 발급받고 수정하였더니 정상적으로 돌아가긴 했지만, 수동으로 바꿔줘야하는 문제 발생 -> playwright으로 X 로그인하여 자동으로 쿠키 갱신하는 방법 ( storage_state 로 갱신 가능함 json파일이 자동으로 바뀜)
